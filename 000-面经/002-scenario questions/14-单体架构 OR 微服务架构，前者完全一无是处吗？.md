面试官在面试中经常会问到这样一个问题：“你的项目是单体架构还是微服务架构？”

候选人当然会说：“我们的项目是采用微服务架构进行设计的。”

这时，面试官就会“趁机”抛出这样的问题：“微服务架构就一定比单体架构好吗？”

如果候选人提前没有准备的话，这个问题就会回答得没有体系化和结构化，不能有说服力地给面试官满意的答案。

对于这个问题，我们可以`沿着如下步骤`去进行回答：

1.  顺着面试官的观点，明确 Say No，微服务架构不一定比单体架构好。
1.  说说微服务架构和单体架构各自的优缺点和适用场景。
1.  解释清楚，为什么你的项目是采用的微服务架构。
1.  （可选）如果你的系统是从单体架构往微服务架构演进的，可以说下演进过程和方法论。

如果回答得清晰得当，有理有据，那一定是个大大的加分项。




## 优缺点 & 适用场景

既然微服务架构不一定比单体架构好，那么接下来，我们就需要跟面试官交待清楚，微服务架构和单体架构各自的优缺点和适用场景。



### 单体架构

顾名思义，一个大单体服务中，包括系统的所有功能模块，且该服务会完整地部署在应用服务器上。并且，研发团队中的多个工程师共同开发维护这一个大单体服务。

<p align=center><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8c49534520964085b6b6477754b413e8~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=539&h=375&s=55491&e=png&b=ffffff" alt=""  /></p>



打个比方，单体架构就像是社区门口的便利店，麻雀虽小，五脏俱全。

从存在即合理的角度，单体架构还是具备一些`优点`的，具体如下：

- **小型系统开发效率高**。工程师可以快速地在一个项目工程，以及其对应的数据库中完成所有代码的开发调试，无需在多个项目工程中来回切换。

- **技术实现简单**。分布式系统复杂的跨网络通信问题、跨库查询问题、跨库事务问题，以及跨服务的链路追踪问题，这里统统不涉及。

- **性能优势**。系统中的所有功能模块全部都在一个进程中运行，不会产生额外的网络消耗。

而从硬币两面性的角度，单体架构被人吐槽的`缺点`也同样不少。

- **可用性低**。系统中任意一个模块出现资源耗尽类的故障，会导致整个系统无法运行。

- **难以维护和扩展**。当系统越来越庞大、功能实现越来越多时，在一个项目工程中的代码实现会变得越来越复杂和臃肿。

- **团队并行度低**。多个工程师对一个项目工程进行开发，会导致代码提交冲突，出现相互影响的情况。同时，对一个项目工程频繁发布上线，也会出现排队等待的情况。

- **很难引入新的技术**。毕竟单体服务的大范围技术改造升级，只有 0 和 100，牵一发而动全身。

接着再说下单体架构的`适用场景`。那种**不足 10 人小型研发团队，维护一个天花板很低、根本做不大的小系统**，比如：企业内部使用的 OA 系统，或是需要快速试错、先从 0 到 1 地搞起来再说的新系统，单体架构必须是唯一的选择。



### 微服务架构

按照业务领域，将系统拆分成多个单一职责、小而自治的服务，每个服务独立部署，每个服务都有自己独立的库表，各服务之间通过网络进行相互调用。

并且，每个服务都有自己对应的工程师进行开发维护，职责边界清晰，高度自治。

  

<p align=center><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2707e425541745c9808df38b69408756~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=667&h=370&s=68437&e=png&b=ffffff" alt=""  /></p>


同样打个比方，微服务架构比较像规模较大的超市，生鲜区、调料区、百货区、零食区边界分明，且有各自的工作人员进行售卖和维护。其`优点`在于：

- **能够提升系统的可用性**。因为微服务架构具备天然隔离性，可以使用下游熔断、超时丢弃，以及核心链路隔离等策略。

- **可维护性和扩展性高**。毕竟相比较于单体架构，微服务架构的一拆多是在分而治之地做减法。

- **具备庞大系统的并行开发能力**。微服务架构下，代码提交冲突导致互相影响的概率会降低，排队等待上线的情况也会减少。

- **容易引入新的技术**。可以选择一个边缘服务来试验新技术，充分验证其价值后，再由点及面地推广到整个系统的所有服务中。

虽然微服务架构有诸多优点，但其`缺点`同样不可小觑：

- **带来了分布式系统的复杂性**。如上文说的：跨网络通信问题、跨库查询问题、跨库查询问题、跨库事务问题，以及跨服务的链路追踪问题。

- **性能有损**。毕竟微服务架构的跨网络运程调用，是要消耗一些性能的。

- **增加了研发运维成本**。比如：上下游联调、测试环境维护，以及跨团队的大需求在发布上线的时候，需要按顺序从下游到上游，部署很多微服务。

微服务架构`适用场景`要比单体架构好解释一些。

大公司、大团队的复杂系统，微服务架构同样是唯一选择。另外，公司的业务处于高速发展期，系统的功能完善性和研发团队的规模也都在与时俱进，此时也务必要从单体架构往微服务架构进行演进。

交待完微服务架构和单体架构各自的优缺点和适用场景，我们就可以顺理成章地跟面试官说下，为什么我们的项目采用的是微服务架构了。



## 为什么采用微服务架构

如上文所说，如果候选人符合场景 1：“大公司、大团队的复杂系统”，那根本不需要进行解释。

若不满足于场景 1，则只有场景 2 适用于微服务架构了。场景 2 需要满足如下条件：

1. 系统对应的后端工程师人数在 10 人以上。
2. 相对核心的，对公司业务价值较大的系统。
3. 目前在快速功能迭代中的系统。

然后，我们再跟面试官说下，项目是如何从单体架构往微服务架构演进的。



## 单体架构 ——> 微服务架构

需要注意的是，从单体架构往微服务架构演进，不要直接“推倒重来，一步到位”。

“推倒重来，一步到位”是指，从零开始开发一个与现有单体架构系统功能完全相同的、基于微服务架构的系统。新系统上线之日，现有系统的一切缺陷和不足全部都烟消云散了。

听起来似乎很美好，但基本上都会以失败告终。原因在于：

（1）在重写新系统的同时，老系统还在承接业务团队的新需求，那就会导致新系统也必须把这些新需求全部实现一遍，当功能完全追平老系统时，才能上线完成替换。

这就意味着，研发团队在追逐的目标是动态的、不断变化的。

（2）当研发团队投入大部分人力开发新系统，那就意味着老系统的业务迭代会慢很多。长此下去，会引起公司业务团队的不满情绪。

在这种不满情绪下，非常容易引起研发团队压力过大，为最终的失败埋下种子。

而微服务架构演进的正确姿势，则是八个字 —— “**徐徐图之，逐步构建**”，让单体服务的功能越来越少，直至完全消失，取而代之的是一个全新的微服务架构系统。

具体的逐步构建策略如下：

### 1. 将新功能实现为微服务

这样做的目的是，控制大单体服务往臃肿复杂的方向继续发展，即：如果你发现自己已经陷入困境，那就不要再给自己继续挖坑了。

我们还是以上文中的电商平台作为举例，假如某天，产品经理希望在系统里面增加 “用户评价” 功能，具体实现方式如下图：

<p align=center><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/01c801eab76a4fcf8728682c9420df28~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=634&h=365&s=58287&e=png&b=ffffff" alt=""  /></p>


通过上图我们可以看到，微服务已经开始在系统中承接新的功能，并逐渐发挥出价值了。

并且，作为全新的服务，之前一直种草、但没机会使用的新技术栈走起。



### 2. 将大单体服务的模块迁移到微服务中

如果说 “将新功能实现为微服务” 是在控制增量（控制大单体服务往臃肿复杂的方向继续发展）的话，那 “大单体服务的模块迁移到微服务中” 则是在消化存量。

另外需要注意的是，这个操作不是直接无脑地一个一个迁移，而是需要掌握时机的。

最好的时机就是，**在某个模块需要进行大的需求迭代的时候进行迁移**。这样不仅完成了迁移重构的工作，同时也完成了需求开发的工作，相当于一举两得。

我们继续以上文中的电商平台作为举例，假如某天，产品经理希望把系统中的 “客服模块” 进行大的升级改造，这就是个非常好的时机。

<p align=center><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f7095197902645c2a2fc501f9668659a~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=661&h=364&s=61185&e=png&b=ffffff" alt=""  /></p>


还有两点需要注意：

（1）按照微服务架构设计模式，每个服务需要独立库表的，因此客服服务的迁移，同时也需要把其对应的库表也迁移过来。

但如果在之前的单体服务中，存在大量的客服模块与其他模块的多表关联 SQL，这种情况就比较麻烦。如果时间不充足的话，建议先放弃最标准的 “微服务独立库表” 规范，保持一个中间态，后续再慢慢重构成最标准的样子。

（2）重构过程中，不要马上把单体服务中的 “客服模块” 代码删除，因为一旦本次的 “新功能迭代 + 微服务迁移” 上线不成功，可以马上通过配置中心修改配置，将系统切换成原先的版本。

我的建议是，本次的 “新功能迭代 + 微服务迁移” 上线完成，经过几天的试运行，没有发现任何问题的时候，就可以将单体服务中的冗余代码删除了。这样，单体服务的体量也就缩小了。

上文所讲的演进过程和方法论，大家一定要记住，这会给面试官一种 “确实落地实践过，而不是纯纸上谈兵” 的感觉。



## 总结

以上就是对于 “微服务架构一定比单体架构好吗” 的整体解答，大家在回答这个问题的时候，一定记得按照我们在文章开头梳理的步骤，逐层递进地进行回答。

还有一个关键点是，**一定要想方设法地跟自己简历中的项目进行带入**，这样面试官才会觉得该候选人有实际落地的经验，而不是一个单纯的理论派。